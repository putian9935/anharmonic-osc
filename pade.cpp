#include <gmpxx.h>
#include <iostream>

#include "simple_poly.hpp"
#include <Eigen/Dense>
#include <iomanip>

#define N 50
#define M 50
#define COEFF_NUM N + M + 1

mpq_class coef[COEFF_NUM] = {
    1,
    mpq_class("-3/4"),
    mpq_class("-21/16"),
    mpq_class("-333/64"),
    mpq_class("-30885/1024"),
    mpq_class("-916731/4096"),
    mpq_class("-65518401/32768"),
    mpq_class("-2723294673/131072"),
    mpq_class("-1030495099053/4194304"),
    mpq_class("-54626982511455/16777216"),
    mpq_class("-6417007431590595/134217728"),
    mpq_class("-413837985580636167/536870912"),
    mpq_class("-116344863173284543665/8589934592"),
    mpq_class("-8855406003085477228503/34359738368"),
    mpq_class("-1451836748576538293163705/274877906944"),
    mpq_class("-127561682802713500067360049/1099511627776"),
    mpq_class("-191385927852560927887828084605/70368744177664"),
    mpq_class("-19080610783320698048964226601511/281474976710656"),
    mpq_class("-4031194983593309788607032686292335/2251799813685248"),
    mpq_class("-449820604540765836160529697491458635/9007199254740992"),
    mpq_class("-211491057584560795425148309663914344715/144115188075855872"),
    mpq_class("-26120222383762781149654970754934417034805/576460752303423488"),
    mpq_class(
        "-6763740228794489740596394161822714805728135/4611686018427387904"),
    mpq_class(
        "-916117527799746577984641800484328417887454935/18446744073709551616"),
    mpq_class("-1036464696105720129803188216619901855131610583785/"
              "590295810358705651712"),
    mpq_class("-152773774949844438983482018830957022324392611587683/"
              "2361183241434822606848"),
    mpq_class("-46864661934282542604967271035084212028364938136115903/"
              "18889465931478580854784"),
    mpq_class("-7468424771414634117845409123534119931849505977965315619/"
              "75557863725914323419136"),
    mpq_class("-4939479898777642568776881638048610516053578367250019222857/"
              "1208925819614629174706176"),
    mpq_class("-846284774074565106837237848622053215062153108475654677813615/"
              "4835703278458516698824704"),
    mpq_class("-300121824583301012159970897013428849261973957431788548963467657"
              "/38685626227668133590597632"),
    mpq_class("-550137962604360129619153285813860117529187679765987381268192630"
              "89/154742504910672534362390528"),
    mpq_class("-333240020344369737849675013849465176026142994492806680094689746"
              "926621/19807040628566084398385987584"),
    mpq_class("-650760551740220715683818900757935023034628057067170177113905476"
              "42799543/79228162514264337593543950336"),
    mpq_class("-261961027400352357526789125531301433400305655527706397382117492"
              "76321280935/633825300114114700748351602688"),
    mpq_class("-542950362306829016346819979508093667422738798238215265776648226"
              "0304499995635/2535301200456458802993406410752"),
    mpq_class("-463147982056911591905245354366441250236437591260313434415521957"
              "3167803001916007/40564819207303340847894502572032"),
    mpq_class("-101543888909089217778099131933482140861610157951332522302211987"
              "3844127738685843305/162259276829213363391578010288128"),
    mpq_class("-457434181185240616571298197385274519570309753116298319551669175"
              "466660293397126000219/1298074214633706907132624082305024"),
    mpq_class("-105773672925610672077302486488887096882750882938362897510560200"
              "115737495193422101413435/5192296858534827628530496329220096"),
    mpq_class(
        "-200738015204206438773807584391706805459910769533187349347664421355735"
        "913747266729477812003/166153499473114484112975882535043072"),
    mpq_class(
        "-488234137176864969572150619367971442870371184596054620443662554777644"
        "80845997041190000837105/664613997892457936451903530140172288"),
    mpq_class(
        "-243349184917181844195209273725749365374451325844932516499126177740270"
        "23765184670151964125475069/5316911983139663491615228241121378304"),
    mpq_class(
        "-621046513355337719058805452203633711304308377877218412679509676296395"
        "9301963619314146520934896985/21267647932558653966460912964485513216"),
    mpq_class("-648875904602325569683221889683831000005440142715375953447187207"
              "5642219729693682705055581596307073095/"
              "340282366920938463463374607431768211456"),
    mpq_class("-173378045140240992338451243103456888431084689090852749267782227"
              "7773646060899055458065451021503409160465/"
              "1361129467683753853853498429727072845824"),
    mpq_class("-947312357260952709124304013622856930117446354369520661438441772"
              "174434895491815401993721734674906330825615/"
              "10889035741470030830827987437816582766592"),
    mpq_class("-264478347117583696763861416487974937521615516113571573316135145"
              "604779260888480072911288293228253988559930615/"
              "43556142965880123323311949751266331066368"),
    mpq_class("-120679873284612313854999379410280169595291711905842885236913189"
              "7934854567167845643634942880584755481187842675865/"
              "2787593149816327892691964784081045188247552"),
    mpq_class("-351395105200425215330838554451976924478485719346400535951975084"
              "616707436051061016213347936952027763722452616359835/"
              "11150372599265311570767859136324180752990208"),
    mpq_class("-208852066265545944642087879843646908751339472756098960632783131"
              "926454687409501660022062439675130333171343608582714835/"
              "89202980794122492566142873090593446023921664"),
    mpq_class("-633180416771539144637506138743740530910298110480842431960208482"
              "77390527253714601657718845442151633120615277746136814431/"
              "356811923176489970264571492362373784095686656"),
    mpq_class("-783036668292754434051004754752080202764567728616507391135423056"
              "34224059261254472020176318371199181300501824420862744450695/"
              "5708990770823839524233143877797980545530986496"),
    mpq_class("-246785410731771283285476565155528001339756582781090332519377497"
              "00165846031439389977283463896497521362248085975824556642601689/"
              "22835963083295358096932575511191922182123945984"),
    mpq_class("-158515799109573128011575687162447450948507755284700119103922915"
              "5060137875342643345408820391856149011609848281766389259879463251"
              "5/182687704666362864775460604089535377456991567872"),
    mpq_class("-518597082448987105385606785468286325180289923041757749475979212"
              "7071120686170781256252386374827259078925844254626562111860399322"
              "739/730750818665451459101842416358141509827966271488"),
    mpq_class("-138218518352183242281435186265131308095162581695725535918097733"
              "0753543481710571190175966030332595697981073065851109043314774938"
              "1357025/23384026197294446691258957323460528314494920687616"),
    mpq_class("-468770729551805077446667033499234210573748991586934863391937916"
              "3112476602184000150185527261783903670052310164405987927064087619"
              "643867883/93536104789177786765035829293842113257979682750464"),
    mpq_class(
        "-323591527147980844418562910881630124770204504853515340706005307752364"
        "8168770263731680544033224360507204446008749690531066952596904975344375"
        "/748288838313422294120286634350736906063837462003712"),
    mpq_class(
        "-113627958343920123484050138005708087802363453929415959290692789305697"
        "2676848512002654852599024652171587238568215274316645867243049348251803"
        "035/2993155353253689176481146537402947624255349848014848"),
    mpq_class(
        "-162325997939239133487809492826974003937718960237060580271352886364897"
        "5213422895399534030904796396807023409474508404800688399870119613066156"
        "711545/47890485652059026823698344598447161988085597568237568"),
    mpq_class(
        "-589472329658404347182720217382745610295451544576049922534236447834929"
        "6176020976974762940638540001275616568020872539938535316450204095027936"
        "99294111/191561942608236107294793378393788647952342390272950272"),
    mpq_class(
        "-435193949767706488635582279813071083425556734791184191194153794324269"
        "1212090628003259856742893864375922373389967324497959619026174064471705"
        "88376368425/1532495540865888858358347027150309183618739122183602176"),
    mpq_class("-163256997943085396138773805702505108452759622852581743045786281"
              "5381185397122214135301141021391278610950671971693608677180075701"
              "73803543231494574272644337/"
              "6129982163463555433433388108601236734474956488734408704"),
    mpq_class("-398225744618918494512158853707073490079997218136189966895962521"
              "2059088137353092083426956303931370198780925161026381998977622961"
              "808902671785582548794812123485/"
              "1569275433846670190958947355801916604025588861116008628224"),
    mpq_class("-154165788229299897586477357212347531425798848670053830703651032"
              "3269094642036529206462372998645882530660864626119163700812619525"
              "796848018049669199950600273372887/"
              "6277101735386680763835789423207666416102355444464034512896"),
    mpq_class("-121214235186161660972197401936353623988631183313373862928249985"
              "2173117263441367638801786220319167601280113929692199851248908036"
              "436594177868328753217617614308054935/"
              "50216813883093446110686315385661331328818843555712276103168"),
    mpq_class("-483799227378685448722637049228416595867147844563502747129076229"
              "5190914062578424668176992305614161250844089492246034760124246660"
              "54335703784925620892154335032898673091/"
              "200867255532373784442745261542645325315275374222849104412672"),
    mpq_class("-783997384222914076223799028111595075024105698139359437370202775"
              "9884279736420709856635314309362081708142388270633174933595872584"
              "38582485794897599728502031169442544937215/"
              "3213876088517980551083924184682325205044405987565585670602752"),
    mpq_class("-322319687804134552735601402087677350796958013390177435881211745"
              "0818909255573970291843792852535489434425331948610296680180395364"
              "09100928370329298555069076968125490218620785/"
              "12855504354071922204335696738729300820177623950262342682411008"),
    mpq_class(
        "-268892959292222861283594444370955990301643036493828083538430805812863"
        "1374899435509790837073271829672908525852104062919509102674198306017447"
        "98043657913065398971448085410337955/"
        "102844034832575377634685573909834406561420991602098741459288064"),
    mpq_class(
        "-113773904148301536932382627662772481471680012255436391712776406848640"
        "1186229651023856065558803954727287234997864451796018284775974704623071"
        "26511078970410905090881783044874449955/"
        "411376139330301510538742295639337626245683966408394965837152256"),
    mpq_class(
        "-390579350176596488172526027539597564499946385694596471059574251805172"
        "4620938417674886823329039319180245654380529582110614260923200737548140"
        "39967127099225429743291502014977599198015/"
        "13164036458569648337239753460458804039861886925068638906788872192"),
    mpq_class(
        "-169947389749018833138914146233667808184590813062735183096802475752810"
        "6454298309458415982740031302213504624659253906929060652766903064608921"
        "73630896022478691963792664015485462011605765/"
        "52656145834278593348959013841835216159447547700274555627155488768"),
    mpq_class(
        "-149932510496719239702458510228638452165121714029104889574028075120154"
        "8196147350096328928187705985487160936488532491451618480906497841520401"
        "96889375412991751270953904068586278557772305905/"
        "421249166674228746791672110734681729275580381602196445017243910144"),
    mpq_class(
        "-670367521422527319323027256295662587618387589155834818757584629101881"
        "1020628293587752515802230612751099796011196004766697868704057658909307"
        "9445505025777306049845600236215615031170453600669/"
        "1684996666696914987166688442938726917102321526408785780068975640576"),
    mpq_class(
        "-121500429531994555370627025881739789791074697138190338216571983872094"
        "6935043077995153380529397661896080017092266633888491416965490759473200"
        "05549558991021833570816295745206043162501447847649595/"
        "26959946667150639794667015087019630673637144422540572481103610249216"),
    mpq_class(
        "-557820279730149912686322487045232186092202837204664976064305910765627"
        "4746780329921694198780971650492040409269297503252114648099463909304209"
        "7317138682603153528588798941371461031651986270043298269/"
        "10783978666860255917866806034807852269454857769016228992441444099686"
        "4"),
    mpq_class(
        "-518893590963253093499634928010670614163486084727014749877472542434408"
        "0138983553092784407843890441359680477884681594328243956541710462978986"
        "7770336303571480825344664019901558887628950370685757745715/"
        "86271829334882047342934448278462818155638862152129831939531552797491"
        "2"),
    mpq_class(
        "-244454276089150830196516589721875066409032168887834062184348003523782"
        "8085556742701900755956339032984983724454541859901523698091850931572782"
        "0368635368752548806712585356912586040089285229643937145975195/"
        "345087317339528189371737793113851272622555448608519327758126211189964"
        "8"),
    mpq_class(
        "-186608702228183155080141849401754271668052020930355158648067915464071"
        "1465295581251621618273538322799601219166410354358684931276210957669499"
        "38892819407668471163410395399625242798184900463437503976373632275/"
        "2208558830972980411979121875928648144784354871094523697652007751615774"
        "72"),
    mpq_class(
        "-901514009116320616016608969780761392105621334937400845424613917789706"
        "5360976950080473627995491246863012750674862543639692603354359513257293"
        "7774971288510727492141254758093651157146945840200388684885612865481/"
        "8834235323891921647916487503714592579137419484378094790608031006463098"
        "88"),
    mpq_class(
        "-881865691625493454340110679859420340282167740982860106122030839992074"
        "0433714641051214101823188577709836878475572741033012098660132367294295"
        "9908505957961521766176474717447167364639896708529581863508089658486625"
        "/706738825911353731833319000297167406330993558750247583248642480517047"
        "9104"),
    mpq_class("-436612837923487022233776880091332450459440989880541151935858635"
              "6535422921000817748563499873878829040158065850838311320090821451"
              "0394300231742136313457781069820125645002912888014689713826847384"
              "011801582710167638917/"
              "2826955303645414927333276001188669625323974235000990332994569922"
              "0681916416"),
    mpq_class("-875146781195202503671557368118091878278294764861932288803093112"
              "2516969913890065163073491474799053077339336738344957523401944632"
              "7862514836661528092707482583796885684603201866689816621334341096"
              "757649985520570784862005/"
              "4523128485832663883733241601901871400518358776001584532791311875"
              "30910662656"),
    mpq_class("-443785844291244590804804705491117001912408407320104187262372089"
              "7611507608478133171259842202009846098066833272355241441553493907"
              "0530167011441064101507181093777041092787253975625095512092187460"
              "462863909125056895201822795/"
              "1809251394333065553493296640760748560207343510400633813116524750"
              "123642650624"),
    mpq_class("-455410848465831299485135304708089721017036109870250016484948162"
              "1173545474046974877827838839182508837393135954968432306853388034"
              "8677872596291057693779233458358761175981406879294276997391455231"
              "422394356761068163358789068825/"
              "1447401115466452442794637312608598848165874808320507050493219800"
              "0989141204992"),
    mpq_class("-236402109198563946786489598372886312499245096210009303475796525"
              "5870523231316225167172851430224463565370875088326457933662953594"
              "8878421031391297927384212640035365921980541771535638956792494128"
              "766779655586298392281891766281865/"
              "5789604461865809771178549250434395392663499233282028201972879200"
              "3956564819968"),
    mpq_class("-993068884298919080451514716276966835886623187458830967531595356"
              "7439243936102798663342582417008864149102297540212303496222265540"
              "8172313372228918325220505317379618429595147041741626945791603272"
              "618729752346632371167140045242844175/"
              "1852673427797059126777135760139006525652319754650249024631321344"
              "126610074238976"),
    mpq_class("-527412983994040678179438513097206342370100314586464312104223577"
              "0115505379032122286506547151493630579781521831409268800602432596"
              "0669098517958163219034902220761775342841475734409719734168564375"
              "874618550338228448892664562453957421445/"
              "7410693711188236507108543040556026102609279018600996098525285376"
              "506440296955904"),
    mpq_class("-566539594014591039589437361353474277087230341711258525025038875"
              "9411614088267837890374552108130356001019798011605201601441213284"
              "3968815180524934376708853013689046904561787484183288292240770301"
              "826822987771959666124743589948985430818345/"
              "5928554968950589205686834432444820882087423214880796878820228301"
              "2051522375647232"),
    mpq_class("-307683049400647541173048160122582121222566339577403350451126024"
              "4534233263163886833613212826652149768715011487875147295659029916"
              "2126920630900433712780634219642520595906780314594176516558538289"
              "966162383643446208337229962171112384190766565/"
              "2371421987580235682274733772977928352834969285952318751528091320"
              "48206089502588928"),
    mpq_class("-675783749622606402820787289035897951012179232353273876176979636"
              "8408298482506877742936457630088211658361021618276439324176908029"
              "4272166444661165769349802053158052197900969557637020768031271199"
              "361892995069168636292133647662103578605363491775/"
              "3794275180128377091639574036764685364535950857523710002444946112"
              "771297432041422848"),
    mpq_class("-375120657977886210424541618944714588686850381850471916729642408"
              "7518361620992456562200917864851577128146801672029405555904453871"
              "9643005120563591596869391034745550964029631806968939404209195255"
              "719749047851139232362689577353374960411656709102985/"
              "1517710072051350836655829614705874145814380343009484000977978445"
              "1085189728165691392"),
    mpq_class("-420951984498901867295625438352254581856968083500936237043904355"
              "5503811452703133278916247462728003324974165314020441983524145307"
              "6681346601210300891653756672332412129508944959176093777330496393"
              "862364690417690165678905491126757422954797555341975455/"
              "1214168057641080669324663691764699316651504274407587200782382756"
              "08681517825325531136"),
    mpq_class("-238716732443229295334272635204579156259874200780217309474605924"
              "7476040243038368533062060064416326907499228127847194676761722970"
              "4196874083956501136813402801176430312106416698981577421365921769"
              "703779960549100186148778601724595563826267084914999325495/"
              "4856672230564322677298654767058797266606017097630348803129531024"
              "34726071301302124544"),
    mpq_class("-437777330027513718382465331472964822550050910866686120499865584"
              "9453817007806831055365466542136671009516995347217309227392822562"
              "2110814389879647072774988411134576380926698701507590012014608474"
              "2407070848065757683004251395746759760863657100807547615425785/"
              "6216540455122333026942278101835260501255701884966846468005799711"
              "1644937126566671941632"),
    mpq_class("-253510673884709225791993979833797681172032734009893062082309239"
              "6658066642412449345288041308186877254490983604893609735782740193"
              "8860035157652738895483467715916031805003444379074504701128273911"
              "7262157890520745818216887675317021093485741050998332915177573515"
              "/248661618204893321077691124073410420050228075398673858720231988"
              "446579748506266687766528"),
    mpq_class(
        "-296650567748632260596337096251239011961175255058503663812523113292501"
        "9566118485243066096008782181785999607921339175814701246306997367518397"
        "2883694803271854266329285277328533473834214470420395973546175571529667"
        "4753026977198964166388092312914723099432443954395/"
        "1989292945639146568621528992587283360401824603189390869761855907572637"
        "988050133502132224"),
    mpq_class(
        "-175345422755518012962289999437806177144470334770282536289103832217751"
        "5720753568510263431537385889996209852193983628385032248560551215197172"
        "2572791774002676278973276814644042929357785346417783149219610884824092"
        "3627962536298908254165516230770505100731680974459255/"
        "7957171782556586274486115970349133441607298412757563479047423630290551"
        "952200534008528896"),
    mpq_class(
        "-418783209574852460594758294269036988001626462879229780026348773382141"
        "7259930062290484427080138253842161250173908984941843608395640039751570"
        "1600055913337614548315628564314810175724859550529887294344947875490759"
        "2926930657733855374025695150778783660618847102306340395/"
        "1273147485209053803917778555255861350657167746041210156647587780846488"
        "31235208544136462336")};

template <typename _Scalar, int deg>
Polynomial<_Scalar, deg - 1>
vector_to_poly(Eigen::Vector<_Scalar, deg> const &v) {
  Polynomial<_Scalar, deg - 1> ret;
  for (int i = 0; i < deg; ++i) {
    ret[i] = v[i];
  }
  return ret;
}

int main() {
  Eigen::Matrix<mpq_class, M, M> a_coef;
  for (int i = 0; i < M; ++i) {
    for (int j = 0; j < M; ++j) {
      a_coef(i, j) = coef[N + i - j];
    }
  }

  Eigen::Vector<mpq_class, M> rhs;
  for (int i = 0; i < M; ++i) {
    rhs(i) = -coef[N + i + 1];
  }
  Eigen::Vector<mpq_class, M> b = a_coef.fullPivLu().solve(rhs);

  Eigen::Vector<mpq_class, N + 1> a;
  for (int i = 0; i <= N; ++i) {
    a(i) = coef[i];
    for (int j = 0; j < i; ++j) {
      a(i) += coef[i - j - 1] * b(j);
    }
  }

  std::cout << std::setprecision(15); 
  
  auto poly_b = vector_to_poly(b);
  for (int num = -100; num <= 100; ++num) {

    mpq_class const eps(num, 10);
    mpq_class const res =
        vector_to_poly(a).evaluate(eps) /
        (poly_b * make_polynomial<mpq_class, 1>({mpq_class(0), 1}) +
         make_polynomial<mpq_class, 0>({mpq_class(1)}))
            .evaluate(eps);
    std::cout << res.get_d() << '\n';
  }
}